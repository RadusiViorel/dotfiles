#!/usr/bin/env bash

source "${HOME}/.config/xmobar/scripts/vars"

WARNING_COUNT=15

packageList=$(xbps-install -nuM)
count=$(printf "%s\n" "$packageList" | grep -cve '^\s*$')

show() {
    # Open a terminal and run the commands
    $TERM -e bash -c "echo -e '$packageList \n Updated $count packages:\n'; sudo xbps-install -Su; echo; read -p 'Press enter to exit...'"
}

case "$1" in
    show) show ;;
    *) ;;
esac

(( count == 0 )) && exit 0

output="ï‘ª  $count"

if (( count >= WARNING_COUNT )); then
    echo "<fc=${COLOR_WARNING}>${output}</fc>${SEP}"
else
    echo "$output ${SEP}"
fi
