#!/usr/bin/env bash

# Parse named parameters
for arg in "$@"; do
  case $arg in
    --OUTPUT_FILE=*) OUTPUT_FILE="${arg#*=}" ;;
    *) echo "Unknown argument: $arg" ; exit 1 ;;
  esac
done


# Build xmobar-friendly line with relative time
result=$(awk -F'|' '
{
  age = systime() - $4
  if (age < 60)       ago = age "s ago"
  else if (age < 3600) ago = int(age/60) "m ago"
  else                ago = int(age/3600) "h ago"

  printf "󰖩 %s \n\n↓ %s Mbits/s\n↑ %s Mbits/s\n(%s)\n", $1, $2, $3, ago
}' "$OUTPUT_FILE")


notify-send "${result}"
