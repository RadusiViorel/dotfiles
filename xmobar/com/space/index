#!/usr/bin/env bash

source "${HOME}/.config/xmobar/scripts/vars"
source "${HOME}/.config/xmobar/scripts/state"
source "${HOME}/.config/xmobar/scripts/page/index" 1

COM="${HOME}/.config/xmobar/com/space"
STATE_FILE="${HOME}/.config/xmobar/scripts/state"
__toggle="space_toggle"

grep -q "^$__toggle=" "$STATE_FILE" || echo "$__toggle=0" >> "$STATE_FILE"

color="#ffffff"
format="avail"
if [[ "$space_toggle" == 1 ]]; then
  format="used"
  color="${COLOR_WARNING}"
fi

root="$(df -h --output=${format} / | tail -1)"
home="$(df -h --output=${format} /home | tail -1)"

case "$1" in
  toggle) ${COM}/actions/toggle --value=${space_toggle} --STATE_FILE=${STATE_FILE} --KEY=${__toggle} ;;
    *) ;;
esac

echo "<fc=${color}>ï‘³  ${root} /${home}</fc>${SEP}"
